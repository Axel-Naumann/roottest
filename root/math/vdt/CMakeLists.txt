# Copyright (C) 1995-2019, Rene Brun and Fons Rademakers.
# All rights reserved.
#
# For the licensing terms see $ROOTSYS/LICENSE.
# For the list of contributors see $ROOTSYS/README/CREDITS.

if (ROOT_vdt_FOUND AND NOT ROOT_CLASSIC_BUILD AND NOT "${CMAKE_CXX_COMPILER_ID}" STREQUAL "Clang")

set (testname stressVdt)
set(additional_compile_flags "-Ofast")

include_directories(${VDT_INCLUDE_DIRS})

ROOTTEST_GENERATE_EXECUTABLE(${testname}
                             ${testname}.cxx
                             ADDITIONAL_COMPILE_FLAGS ${additional_compile_flags}
                             LIBRARIES Core Hist Gpad MathCore ${VDT_LIBRARIES})

ROOTTEST_ADD_TEST(${testname}
                  EXEC ./${testname}
                  FAILREGEX "too" # for "too slow" and "too inaccurate" :)
                  DEPENDS ${GENERATE_EXECUTABLE_TEST}
                  LABELS longtest)
endif()
